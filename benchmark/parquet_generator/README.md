# Parquet Generator

## Logical data generator

To support flexible parquet file generation, logical data generator is designed to support various configurations, to mimic various parquet scenarios. Below shows some important decisions while implementing the generator

### Column Configurations
Logical data generator is designed support per-column configurations, the configurable settings can be found in the table below, attributes with `*` is required. Attributes `compression` and `encoding` are used by `ParquetGenerator` and is explained here for completeness.

<center>

| Configuration | Description | Accepted Values | Default Value |
| --- | --- | --- | --- |
| *name | Name of the column | String | None, this field is required |
| *dtype | Type of the column | ['int','double','str','struct','list'] | None, this field is required|
| distribution | value distribution of the column, can be further configured using dist_param configuration | ['normal','uniform','unique'] | 'normal' |
| num_null | Number of null values in the column, this field is useful to generate `optional` fields | Non-negative integer | 0 |
| num_repeated | Number of allowed values to be repeated, this field is useful to generate `repeated` fields, when the value is 1 it means `required` field | Integer larger or equal to 1 | 1 |
| dist_params | Extra configurations for distribution | dictionary | None, this field can be empty |
| custom_generator | A customized data generator, when this field is not empty, data for this field will be generated by this generator instead of default distribution generator | A functor | None, this field can be empty |
| compression | Compression method for this column | ['NONE', 'SNAPPY', 'GZIP', 'BROTLI', 'LZ4', 'ZSTD'] | 'NONE' |
| encoding | Encoding algorithm for this column | ['PLAIN', 'BYTE_STREAM_SPLIT', 'DELTA_BINARY_PACKED', 'DELTA_LENGTH_BYTE_ARRAY', 'DELTA_BYTE_ARRAY'] | 'PLAIN' |

</center>

### Design Decisions

1. **Accepted Types**:   
Though parquet support various logical types, the real physical representations for some could be the same. The logical definitions only affect how parquet interpret them after decoding and decompression, for example `DATE` and `INT32` both use 'INT32' as their physical representation. Thus, for current stage only limited logical types are supported, which are shown in the table below, which should be sufficient for current testing stage. Note that `LIST` and `MAP` types are nested structure and their physical types are defined by the elements inside the structure.

<center>

| Supported Data Types | Physical Types in Parquet |
| --- | --- |
| INTEGER| INT64 |
| STRING | BYTE_ARRAY |
| DOUBLE | FLOUT64 |
| LIST   | PRIMARY TYPES | 
| MAP    | PRIMARY TYPES |

</center>

2. **NULL Value and Nested Structure Handling**
Parquet supports three different repetitions, `optional`,`required` and `repeated`. Also, parquet allows nested structures. Logical data generator is designed to support these features. 

3. **Twisted Data Distribution Configurations**
Logical data generator is designed to support per-column distribution configuration. But some settings may twist with each other, and the following semantic definition is used to clear the ambiguity. The 

